import requests
from bs4 import BeautifulSoup
import random
import re
import xlrd
import xlwt
import time
from multiprocessing import Process,Queue,Lock,Pool,Manager
import xlwings as xlw
import pandas as pd
import os
from excel import model_excel
he={'user-agent':'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36','content-encoding':'gzip'}
head={'content-type': 'application/x-www-form-urlencoded; charset=UTF-8','user-agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36'}
cookie={'cookie':'_ga=GA1.2.810355764.1500871622; aQQ_ajkguid=1338E52E-2388-F9AA-9624-93AE4EA76B93; 58tj_uuid=89ef1c54-2800-412c-bc48-4e8a743021e6; Ref=https%3A%2F%2Fm.anjuke.com%2Fsu%2Fmap%2F%3Fadr%3D%25E7%258B%25AC%25E5%25A2%2585%25E6%25B9%2596%25E5%25A4%25A7%25E9%2581%2593%252C%25E8%25BF%2591%25E6%259D%25BE%25E6%25B6%259B%25E8%25B7%25AF%26lng%3D120.737581%26lat%3D31.286915%26tp%3Dcomm%26id%3D813146%26from%3Dxqdy_map; isp=true; sessid=58e48045-9d52-439f-8129-f18677c07c0e; Hm_lvt_c5899c8768ebee272710c9c5f365a6d8=1577693292; id58=e87rkF7Hd9gMXq/oC5adAg==; __xsptplus8=8.92.1590383399.1590383650.3%232%7Cwww.baidu.com%7C%7C%7C%25E6%2598%258E%25E4%25B8%25B0%25E9%2598%25B3%25E5%2585%2589%25E8%258B%2591%7C%23%23ht_b0ySkpz-CMN7xlyOC11WNAsjz-RQm%23; wmda_uuid=1c8b9c5239058ee83c159e7f46a39ece; wmda_visited_projects=%3B6289197098934; als=0; browse_comm_ids=6775; ctid=11; _gid=GA1.2.2082832108.1601431540; search_words=%E9%94%A6%E7%BF%A0%E8%8B%91%7C%E4%B8%8A%E6%B5%A6%E8%B7%AF239%E5%BC%84%7C%E4%B8%8A%E6%B5%A6%E8%B7%AF336%E5%BC%84%7C%E4%B8%B0%E7%BF%94%E6%96%B0%E5%9F%8E%7C%E4%B8%89%E4%BD%B3%E8%8A%B1%E8%8B%91; lps=http%3A%2F%2Fwww.anjuke.com%2F%3Fpi%3DPZ-baidu-pc-all-biaoti%7Chttps%3A%2F%2Fwww.baidu.com%2Fother.php%3Fsc.K00000K3pfmuX_wZrorSn5GTK862iE0tShrFkE-142Dlpoz2tHuYQpW6QVlhPvlzBcPK-omRxYgaTnCommeKDHYjUkhihqAhJqHgAbmkBDXkFiWBZg9LMznsTNQGgteiNrAFn2G9Nn0VJHxN-eXFJo2d0PM6Zw7LuZzJlED-Ji1_5Kh6IxXS2Ar6OdsUyWg3iLwVlbR5OKJSxdo70hHMWm5iFRPh.DY_NR2Ar5Od663rj6thm_8jViBjEWXkSUSwMEukmnSrZr1wC4eL_8C5RojPak3S5Zm0.TLFWgv-b5HDkrfK1ThPGujYknHb0THY0IAYq_Q2SYeOP0ZN1ugFxIZ-suHYs0A7bgLw4TARqnsKLULFb5UazEVrO1fKzmLmqnfKdThkxpyfqnHRznHcknW61PfKVINqGujYkn1nkrH6zPsKVgv-b5HDsP1Rsrjnd0AdYTAkxpyfqnHDdn1f0TZuxpyfqn0KGuAnqHbG2RsKWThnqn1c4nHD%26ck%3D2694.8.55.409.156.251.188.148%26dt%3D1601514685%26wd%3D%25E5%25AE%2589%25E5%25B1%2585%25E5%25AE%25A2%26tpl%3Dtpl_11534_23295_19442%26l%3D1521212835%26us%3DlinkName%253D%2525E6%2525A0%252587%2525E5%252587%252586%2525E5%2525A4%2525B4%2525E9%252583%2525A8-%2525E4%2525B8%2525BB%2525E6%2525A0%252587%2525E9%2525A2%252598%2526linkText%253D%2525E5%2525AE%252589%2525E5%2525B1%252585%2525E5%2525AE%2525A2-%2525E5%252585%2525A8%2525E6%252588%2525BF%2525E6%2525BA%252590%2525E7%2525BD%252591%2525EF%2525BC%25258C%2525E6%252596%2525B0%2525E6%252588%2525BF%252520%2525E4%2525BA%25258C%2525E6%252589%25258B%2525E6%252588%2525BF%252520%2525E6%25258C%252591%2525E5%2525A5%2525BD%2525E6%252588%2525BF%2525E4%2525B8%25258A%2525E5%2525AE%252589%2525E5%2525B1%252585%2525E5%2525AE%2525A2%2525EF%2525BC%252581%2526linkType%253D; twe=2; wmda_session_id_6289197098934=1601514689026-6d351536-8b81-df22; init_refer=https%253A%252F%252Fwww.baidu.com%252Fother.php%253Fsc.K00000K3pfmuX_wZrorSn5GTK862iE0tShrFkE-142Dlpoz2tHuYQpW6QVlhPvlzBcPK-omRxYgaTnCommeKDHYjUkhihqAhJqHgAbmkBDXkFiWBZg9LMznsTNQGgteiNrAFn2G9Nn0VJHxN-eXFJo2d0PM6Zw7LuZzJlED-Ji1_5Kh6IxXS2Ar6OdsUyWg3iLwVlbR5OKJSxdo70hHMWm5iFRPh.DY_NR2Ar5Od663rj6thm_8jViBjEWXkSUSwMEukmnSrZr1wC4eL_8C5RojPak3S5Zm0.TLFWgv-b5HDkrfK1ThPGujYknHb0THY0IAYq_Q2SYeOP0ZN1ugFxIZ-suHYs0A7bgLw4TARqnsKLULFb5UazEVrO1fKzmLmqnfKdThkxpyfqnHRznHcknW61PfKVINqGujYkn1nkrH6zPsKVgv-b5HDsP1Rsrjnd0AdYTAkxpyfqnHDdn1f0TZuxpyfqn0KGuAnqHbG2RsKWThnqn1c4nHD%2526ck%253D2694.8.55.409.156.251.188.148%2526dt%253D1601514685%2526wd%253D%2525E5%2525AE%252589%2525E5%2525B1%252585%2525E5%2525AE%2525A2%2526tpl%253Dtpl_11534_23295_19442%2526l%253D1521212835%2526us%253DlinkName%25253D%252525E6%252525A0%25252587%252525E5%25252587%25252586%252525E5%252525A4%252525B4%252525E9%25252583%252525A8-%252525E4%252525B8%252525BB%252525E6%252525A0%25252587%252525E9%252525A2%25252598%252526linkText%25253D%252525E5%252525AE%25252589%252525E5%252525B1%25252585%252525E5%252525AE%252525A2-%252525E5%25252585%252525A8%252525E6%25252588%252525BF%252525E6%252525BA%25252590%252525E7%252525BD%25252591%252525EF%252525BC%2525258C%252525E6%25252596%252525B0%252525E6%25252588%252525BF%25252520%252525E4%252525BA%2525258C%252525E6%25252589%2525258B%252525E6%25252588%252525BF%25252520%252525E6%2525258C%25252591%252525E5%252525A5%252525BD%252525E6%25252588%252525BF%252525E4%252525B8%2525258A%252525E5%252525AE%25252589%252525E5%252525B1%25252585%252525E5%252525AE%252525A2%252525EF%252525BC%25252581%252526linkType%25253D; new_uv=252; _gat=1; new_session=0,xxzl_cid=ca146650b45947d6a73f074d94e43430; xzuid=93a42f04-cd97-4db8-bf6d-fd048828eb2d'}


def sou(url,data):
    s=requests.get(url+"?kw="+data,headers=head,cookies=cookie)
    B_so1=BeautifulSoup(s.text)
    div1=B_so1.select('div[class="house-details"]')
    if div1:
        div2=B_so1.select('div[class="pro-price"] > span[class="unit-price"]')
        div3=B_so1.find_all()
        for ii,div in enumerate(div1):
            dizhi=div.select('div[class="details-item"] > span[class="comm-address"]')
            danjia=div2[ii].text
        
            print(dizhi[0].text.strip())
            print(danjia)




if __name__ == "__main__":
    sou("https://shanghai.anjuke.com/sale/","锦翠苑")
    